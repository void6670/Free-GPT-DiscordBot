/**
 * @name ranges-push
 * @fileoverview Gather string index ranges
 * @version 7.0.10
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-push/}
 */

"use strict";var rangesPush=(()=>{var F=Object.create;var $=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames,T=Object.getOwnPropertySymbols,L=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var w=(s,t,o)=>t in s?$(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o,m=(s,t)=>{for(var o in t||(t={}))O.call(t,o)&&w(s,o,t[o]);if(T)for(var o of T(t))W.call(t,o)&&w(s,o,t[o]);return s};var _=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports),H=(s,t)=>{for(var o in t)$(s,o,{get:t[o],enumerable:!0})},v=(s,t,o,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of B(t))!O.call(s,l)&&l!==o&&$(s,l,{get:()=>t[l],enumerable:!(i=J(t,l))||i.enumerable});return s};var P=(s,t,o)=>(o=s!=null?F(L(s)):{},v(t||!s||!s.__esModule?$(o,"default",{value:s,enumerable:!0}):o,s)),U=s=>v($({},"__esModule",{value:!0}),s);var R=(s,t,o)=>(w(s,typeof t!="symbol"?t+"":t,o),o);var N=_((k,S)=>{"use strict";S.exports=q;function d(s){return s instanceof Buffer?Buffer.from(s):new s.constructor(s.buffer.slice(),s.byteOffset,s.length)}function q(s){if(s=s||{},s.circles)return G(s);return s.proto?i:o;function t(l,e){for(var a=Object.keys(l),r=new Array(a.length),u=0;u<a.length;u++){var n=a[u],f=l[n];typeof f!="object"||f===null?r[n]=f:f instanceof Date?r[n]=new Date(f):ArrayBuffer.isView(f)?r[n]=d(f):r[n]=e(f)}return r}function o(l){if(typeof l!="object"||l===null)return l;if(l instanceof Date)return new Date(l);if(Array.isArray(l))return t(l,o);if(l instanceof Map)return new Map(t(Array.from(l),o));if(l instanceof Set)return new Set(t(Array.from(l),o));var e={};for(var a in l)if(Object.hasOwnProperty.call(l,a)!==!1){var r=l[a];typeof r!="object"||r===null?e[a]=r:r instanceof Date?e[a]=new Date(r):r instanceof Map?e[a]=new Map(t(Array.from(r),o)):r instanceof Set?e[a]=new Set(t(Array.from(r),o)):ArrayBuffer.isView(r)?e[a]=d(r):e[a]=o(r)}return e}function i(l){if(typeof l!="object"||l===null)return l;if(l instanceof Date)return new Date(l);if(Array.isArray(l))return t(l,i);if(l instanceof Map)return new Map(t(Array.from(l),i));if(l instanceof Set)return new Set(t(Array.from(l),i));var e={};for(var a in l){var r=l[a];typeof r!="object"||r===null?e[a]=r:r instanceof Date?e[a]=new Date(r):r instanceof Map?e[a]=new Map(t(Array.from(r),i)):r instanceof Set?e[a]=new Set(t(Array.from(r),i)):ArrayBuffer.isView(r)?e[a]=d(r):e[a]=i(r)}return e}}function G(s){var t=[],o=[];return s.proto?e:l;function i(a,r){for(var u=Object.keys(a),n=new Array(u.length),f=0;f<u.length;f++){var c=u[f],p=a[c];if(typeof p!="object"||p===null)n[c]=p;else if(p instanceof Date)n[c]=new Date(p);else if(ArrayBuffer.isView(p))n[c]=d(p);else{var g=t.indexOf(p);g!==-1?n[c]=o[g]:n[c]=r(p)}}return n}function l(a){if(typeof a!="object"||a===null)return a;if(a instanceof Date)return new Date(a);if(Array.isArray(a))return i(a,l);if(a instanceof Map)return new Map(i(Array.from(a),l));if(a instanceof Set)return new Set(i(Array.from(a),l));var r={};t.push(a),o.push(r);for(var u in a)if(Object.hasOwnProperty.call(a,u)!==!1){var n=a[u];if(typeof n!="object"||n===null)r[u]=n;else if(n instanceof Date)r[u]=new Date(n);else if(n instanceof Map)r[u]=new Map(i(Array.from(n),l));else if(n instanceof Set)r[u]=new Set(i(Array.from(n),l));else if(ArrayBuffer.isView(n))r[u]=d(n);else{var f=t.indexOf(n);f!==-1?r[u]=o[f]:r[u]=l(n)}}return t.pop(),o.pop(),r}function e(a){if(typeof a!="object"||a===null)return a;if(a instanceof Date)return new Date(a);if(Array.isArray(a))return i(a,e);if(a instanceof Map)return new Map(i(Array.from(a),e));if(a instanceof Set)return new Set(i(Array.from(a),e));var r={};t.push(a),o.push(r);for(var u in a){var n=a[u];if(typeof n!="object"||n===null)r[u]=n;else if(n instanceof Date)r[u]=new Date(n);else if(n instanceof Map)r[u]=new Map(i(Array.from(n),e));else if(n instanceof Set)r[u]=new Set(i(Array.from(n),e));else if(ArrayBuffer.isView(n))r[u]=d(n);else{var f=t.indexOf(n);f!==-1?r[u]=o[f]:r[u]=e(n)}}return t.pop(),o.pop(),r}}});var Y={};H(Y,{Ranges:()=>E,defaults:()=>I,version:()=>K});function A(s,t=1){let o="\xA0";function i(e){return Array.from(e).reverse().join("")}function l(e,a,r){let u=r?`
`:"\r",n=r?"\r":`
`;if(!e)return e;let f=0,c=0,p="";for(let g=0,M=e.length;g<M;g++)(e[g]===u||e[g]===n&&e[g-1]!==u)&&c++,`\r
`.includes(e[g])||e[g]===o?(f=0,e[g]===o?p+=e[g]:e[g]===u?c<=a&&(p+=e[g],e[g+1]===n&&(p+=e[g+1],g++)):e[g]===n&&(e==null?void 0:e[g-1])!==u&&c<=a&&(p+=e[g])):(f++,!e[g+1]&&!c&&(p+=" "));return p}if(typeof s=="string"&&s.length){let e=1;typeof+t=="number"&&Number.isInteger(+t)&&+t>=0&&(e=+t);let a="",r="";if(!s.trim())a=s;else if(!s[0].trim()){for(let u=0,n=s.length;u<n;u++)if(s[u].trim()){a=s.slice(0,u);break}}if(s.trim()&&(s.slice(-1).trim()===""||s.slice(-1)===o)){for(let u=s.length;u--;)if(s[u].trim()){r=s.slice(u+1);break}}return`${l(a,e,!1)}${s.trim()}${i(l(i(r),e,!0))}`}return s}var x=P(N(),1);var ee=(0,x.default)();function b(s){return typeof s=="string"}function y(s){return Number.isSafeInteger(s)&&s>=0}function h(s){return s!=null}var Q={strictlyTwoElementsInRangeArrays:!1,progressFn:null};function D(s,t){if(!Array.isArray(s)||!s.length)return s;let o=m(m({},Q),t),i,l;if(o.strictlyTwoElementsInRangeArrays&&!s.every((r,u)=>!Array.isArray(r)||r.length!==2?(i=u,l=r.length,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ${i}th range (${JSON.stringify(s[i],null,4)}) has not two but ${l} elements!`);if(!s.every((r,u)=>!Array.isArray(r)||!Number.isInteger(r[0])||r[0]<0||!Number.isInteger(r[1])||r[1]<0?(i=u,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ${i}th range (${JSON.stringify(s[i],null,4)}) does not consist of only natural numbers!`);let e=s.length**2,a=0;return Array.from(s).sort((r,u)=>(o.progressFn&&(a+=1,o.progressFn(Math.floor(a*100/e))),r[0]===u[0]?r[1]<u[1]?-1:r[1]>u[1]?1:0:r[0]<u[0]?-1:1))}var V="7.0.10";var j={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function C(s,t){function o(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}if(!Array.isArray(s)||!s.length)return null;let i;if(t)if(o(t)){if(i=m(m({},j),t),i.progressFn&&o(i.progressFn)&&!Object.keys(i.progressFn).length)i.progressFn=null;else if(i.progressFn&&typeof i.progressFn!="function")throw new Error(`ranges-merge: [THROW_ID_01] resolvedOpts.progressFn must be a function! It was given of a type: "${typeof i.progressFn}", equal to ${JSON.stringify(i.progressFn,null,4)}`);if(![1,2,"1","2"].includes(i.mergeType))throw new Error(`ranges-merge: [THROW_ID_02] resolvedOpts.mergeType was customised to a wrong thing! It was given of a type: "${typeof i.mergeType}", equal to ${JSON.stringify(i.mergeType,null,4)}`);if(typeof i.joinRangesThatTouchEdges!="boolean")throw new Error(`ranges-merge: [THROW_ID_04] resolvedOpts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof i.joinRangesThatTouchEdges}", equal to ${JSON.stringify(i.joinRangesThatTouchEdges,null,4)}`)}else throw new Error(`emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:
${JSON.stringify(t,null,4)} (type ${typeof t})`);else i=m({},j);let l=s.filter(n=>Array.isArray(n)).map(n=>[...n]).filter(n=>n[2]!==void 0||n[0]!==n[1]),e,a,r;i.progressFn?e=D(l,{progressFn:n=>{r=Math.floor(n/5),r!==a&&(a=r,i.progressFn(r))}}):e=D(l);let u=e.length-1;for(let n=u;n>0;n--)i.progressFn&&(r=Math.floor((1-n/u)*78)+21,r!==a&&r>a&&(a=r,i.progressFn(r))),(e[n][0]<=e[n-1][0]||!i.joinRangesThatTouchEdges&&e[n][0]<e[n-1][1]||i.joinRangesThatTouchEdges&&e[n][0]<=e[n-1][1])&&(e[n-1][0]=Math.min(e[n][0],e[n-1][0]),e[n-1][1]=Math.max(e[n][1],e[n-1][1]),e[n][2]!==void 0&&(e[n-1][0]>=e[n][0]||e[n-1][1]<=e[n][1])&&e[n-1][2]!==null&&(e[n][2]===null&&e[n-1][2]!==null?e[n-1][2]=null:e[n-1][2]!=null?+i.mergeType==2&&e[n-1][0]===e[n][0]?e[n-1][2]=e[n][2]:e[n-1][2]+=e[n][2]:e[n-1][2]=e[n][2]),e.splice(n,1),n=e.length);return e.length?e:null}var K=V,I={limitToBeAddedWhitespace:!1,limitLinebreaksCount:1,mergeType:1},E=class{constructor(t){R(this,"ranges");R(this,"opts");let o=m(m({},I),t);if(o.mergeType&&o.mergeType!==1&&o.mergeType!==2)if(b(o.mergeType)&&o.mergeType.trim()==="1")o.mergeType=1;else if(b(o.mergeType)&&o.mergeType.trim()==="2")o.mergeType=2;else throw new Error(`ranges-push: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof o.mergeType}", equal to ${JSON.stringify(o.mergeType,null,4)}`);this.opts=o,this.ranges=[]}add(t,o,i){var a;if(t==null&&o==null)return;if(h(t)&&!h(o)){if(Array.isArray(t)){if(t.length){if(t.some(r=>Array.isArray(r))){t.forEach(r=>{Array.isArray(r)&&this.add(...r)});return}t.length&&y(+t[0])&&y(+t[1])&&this.add(...t)}return}throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_12] the first input argument, "from" is set (${JSON.stringify(t,null,0)}) but second-one, "to" is not (${JSON.stringify(o,null,0)})`)}else if(!h(t)&&h(o))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_13] the second input argument, "to" is set (${JSON.stringify(o,null,0)}) but first-one, "from" is not (${JSON.stringify(t,null,0)})`);let l=+t,e=+o;if(y(i)&&(i=String(i)),y(l)&&y(e)){if(h(i)&&!b(i)&&!y(i))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_08] The third argument, the value to add, was given not as string but ${typeof i}, equal to:
${JSON.stringify(i,null,4)}`);if(h(this.ranges)&&Array.isArray(this.last())&&l===this.last()[1]){if(this.last()[1]=e,this.last()[2],this.last()[2]!==null&&h(i)){let r=this.last()[2]&&this.last()[2].length&&(!((a=this.opts)!=null&&a.mergeType)||this.opts.mergeType===1)?`${this.last()[2]}${i}`:i;this.opts.limitToBeAddedWhitespace&&(r=A(r,this.opts.limitLinebreaksCount)),b(r)&&!r.length||(this.last()[2]=r)}}else{this.ranges||(this.ranges=[]);let r=i!==void 0&&!(b(i)&&!i.length)?[l,e,i&&this.opts.limitToBeAddedWhitespace?A(i,this.opts.limitLinebreaksCount):i]:[l,e];this.ranges.push(r)}}else throw y(l)&&l>=0?new TypeError(`ranges-push/Ranges/add(): [THROW_ID_10] "to" value, the second input argument, must be a natural number or zero! Currently it's of a type "${typeof e}" equal to: ${JSON.stringify(e,null,4)}`):new TypeError(`ranges-push/Ranges/add(): [THROW_ID_09] "from" value, the first input argument, must be a natural number or zero! Currently it's of a type "${typeof l}" equal to: ${JSON.stringify(l,null,4)}`)}push(t,o,i){this.add(t,o,i)}current(){return Array.isArray(this.ranges)&&this.ranges.length?(this.ranges=C(this.ranges,{mergeType:this.opts.mergeType}),this.ranges&&this.opts.limitToBeAddedWhitespace?this.ranges.map(t=>h(t[2])?[t[0],t[1],A(t[2],this.opts.limitLinebreaksCount)]:t):this.ranges):null}wipe(){this.ranges=[]}replace(t){if(Array.isArray(t)&&t.length)if(Array.isArray(t[0])&&y(t[0][0]))this.ranges=Array.from(t);else throw new Error(`ranges-push/Ranges/replace(): [THROW_ID_11] Single range was given but we expected array of arrays! The first element, ${JSON.stringify(t[0],null,4)} should be an array and its first element should be an integer, a string index.`);else this.ranges=[]}last(){return Array.isArray(this.ranges)&&this.ranges.length?this.ranges[this.ranges.length-1]:null}};return U(Y);})();
/**
 * @name string-collapse-leading-whitespace
 * @fileoverview Collapse the leading and trailing whitespace of a string
 * @version 7.0.5
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-collapse-leading-whitespace/}
 */
/**
 * @name codsen-utils
 * @fileoverview Various utility functions
 * @version 1.6.0
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/codsen-utils/}
 */
/**
 * @name ranges-sort
 * @fileoverview Sort string index ranges
 * @version 6.0.8
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-sort/}
 */
